NUMERO_PROCESSOS = 3

REGRA RECEBIMENTO_MENSAGEM_MARCADORA (processo_env, processo_rec) {
  SE processo_rec NÃO FEZ CHECKPOINT_LOCAL ENTÃO
    ENVIAR_MENSAGEM_MARCADORA(processo_rec);
  SENÃO
    PARAR SALVAMENTO_MENSAGENS(processo_env, processo_rec)
}


REGRA ENVIAR_MENSAGEM_MARCADORA (processo_env) {
  // SALVA O ESTADO DA MAQUINA
  CHECKPOINT_LOCAL();
  // BLOQUEIA O CANAL DE RECEBIMENTO DE MENSAGENS DO "processo_env"
  BLOCKEAR_CANAL(processo_env);
  PARA i = 1 ATÉ NUMERO_PROCESSOS FAÇA
    // ENVIA UMA MENSAGEM MARCADORA PARA O PROCESSO i
    RECEBIMENTO_MENSAGEM_MARCADORA(processo_env, i);
    // SALVA MENSAGENS RECEBIDAS FUTURAMENTE DO PROCESSO i MENOS A DO PROCESSO QUE ACABOU DE RECEBER
    SE processo_env != i
      SALVAMENTO_MENSAGENS(i, processo_env);
}